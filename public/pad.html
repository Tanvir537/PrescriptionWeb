<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional Prescription Pad Designer</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Bengali:wght@400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --light-bg: #f8f9fa;
            --border-color: #ddd;
            --text-dark: #333;
            --text-light: #777;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --hover-bg: #f0f0f0;
        }
        body {
            background-color: var(--light-bg);
            color: var(--text-dark);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        header {
            background-color: var(--primary-color);
            color: white;
            padding: 1rem 2rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        header h1 {
            font-size: 1.5rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .header-actions {
            display: flex;
            gap: 1rem;
        }
        .btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        .btn-primary {
            background-color: var(--secondary-color);
            color: white;
        }
        .btn-primary:hover {
            background-color: #2980b9;
        }
        .btn-success {
            background-color: var(--success-color);
            color: white;
        }
        .btn-success:hover {
            background-color: #219653;
        }
        .btn-outline {
            background-color: transparent;
            color: white;
            border: 1px solid white;
        }
        .btn-outline:hover {
            background-color: rgba(255,255,255,0.1);
        }
        .btn-sm {
            padding: 0.25rem 0.5rem;
            font-size: 0.875rem;
        }
        .btn-icon {
            background: none;
            border: none;
            color: var(--text-light);
            cursor: pointer;
            padding: 0.25rem;
            font-size: 0.8rem;
            transition: all 0.2s;
        }
        .btn-icon:hover {
            color: var(--secondary-color);
        }
        .tabs {
            display: flex;
            background-color: white;
            border-bottom: 1px solid var(--border-color);
            overflow-x: auto;
        }
        .tab {
            padding: 1rem 1.5rem;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            font-weight: 500;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .tab:hover {
            background-color: var(--hover-bg);
        }
        .tab.active {
            border-bottom-color: var(--secondary-color);
            color: var(--secondary-color);
        }
        main {
            display: flex;
            flex: 1;
            overflow: hidden;
        }
        .sidebar {
            width: 400px;
            background-color: white;
            border-right: 1px solid var(--border-color);
            overflow-y: auto;
            padding: 1.5rem;
        }
        .sidebar h2 {
            font-size: 1.2rem;
            margin-bottom: 1rem;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .section {
            margin-bottom: 2rem;
        }
        .section-title {
            font-weight: 600;
            margin-bottom: 0.75rem;
            color: var(--text-dark);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.95rem;
        }
        .form-group {
            margin-bottom: 1rem;
        }
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            font-size: 0.9rem;
            color: var(--text-dark);
        }
        .form-control {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 0.9rem;
            transition: all 0.2s;
        }
        .form-control:focus {
            outline: none;
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }
        textarea.form-control {
            resize: vertical;
            min-height: 60px;
        }
        select.form-control {
            cursor: pointer;
        }
        .color-picker-wrapper {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .color-picker {
            width: 40px;
            height: 40px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            cursor: pointer;
        }
        .color-value {
            flex: 1;
        }
        .toggle-group {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        .toggle-btn {
            flex: 1;
            padding: 0.5rem;
            border: 1px solid var(--border-color);
            background-color: white;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
            border-radius: 4px;
            font-size: 0.85rem;
        }
        .toggle-btn:hover {
            background-color: var(--hover-bg);
        }
        .toggle-btn.active {
            background-color: var(--secondary-color);
            color: white;
            border-color: var(--secondary-color);
        }
        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
        }
        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .checkbox-item input {
            cursor: pointer;
        }
        .preview-container {
            flex: 1;
            padding: 2rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow-y: auto;
            background-color: #f5f5f5;
        }
        .preview-header {
            width: 100%;
            max-width: 900px;
            margin-bottom: 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: white;
            padding: 1rem;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .zoom-controls {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .zoom-btn {
            width: 32px;
            height: 32px;
            border: 1px solid var(--border-color);
            background-color: white;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .zoom-btn:hover {
            background-color: var(--hover-bg);
        }
        .zoom-value {
            min-width: 50px;
            text-align: center;
            font-size: 0.9rem;
        }
        .page-info {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            color: var(--text-light);
        }
        .prescription-pad {
            background-color: white;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            position: relative;
            transition: all 0.3s ease;
            transform-origin: top center;
            border-radius: 8px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        .page-a4 {
            width: 210mm;
            min-height: 297mm;
            padding: 15mm;
        }
        .page-b4 {
            width: 250mm;
            min-height: 353mm;
            padding: 18mm;
        }
        .page-letter {
            width: 8.5in;
            min-height: 11in;
            padding: 0.75in;
        }
        .page-legal {
            width: 8.5in;
            min-height: 14in;
            padding: 0.75in;
        }
        .page-a5 {
            width: 148mm;
            min-height: 210mm;
            padding: 10mm;
        }
        .page-a4.landscape {
            width: 297mm;
            min-height: 210mm;
        }
        .page-b4.landscape {
            width: 353mm;
            min-height: 250mm;
        }
        .page-letter.landscape {
            width: 11in;
            min-height: 8.5in;
        }
        .page-legal.landscape {
            width: 14in;
            min-height: 8.5in;
        }
        .page-a5.landscape {
            width: 210mm;
            min-height: 148mm;
        }
        .prescription-header {
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
            background-color: #fafafa;
            flex-shrink: 0;
        }
        .header-split {
            display: flex;
            justify-content: space-between;
            gap: 2rem;
        }
        .header-left, .header-right {
            flex: 1;
        }
        .header-line {
            margin-bottom: 0.25rem;
        }
        .logo-container {
            width: 100px;
            height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px dashed var(--border-color);
            overflow: hidden;
            margin: 0 auto;
        }
        .logo-container img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
        .logo-placeholder {
            color: var(--text-light);
            text-align: center;
            font-size: 0.8rem;
        }
        .patient-info {
            margin-bottom: 1.5rem;
        }
        .patient-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
        }
        .patient-field {
            display: flex;
            flex-direction: column;
        }
        .patient-field label {
            font-size: 0.8rem;
            color: var(--text-light);
            margin-bottom: 0.25rem;
            font-weight: 500;
        }
        .patient-field input {
            border: none;
            border-bottom: 1px solid var(--border-color);
            padding: 0.25rem 0;
            font-size: 0.9rem;
            background: transparent;
        }
        .patient-field input:focus {
            outline: none;
            border-bottom-color: var(--secondary-color);
        }
        .patient-info.single-line-layout .patient-field {
            flex-direction: row;
            align-items: baseline;
            gap: 0.5rem;
        }
        .patient-info.single-line-layout .patient-field label::after {
            content: ':';
        }
        .patient-info.single-line-layout .patient-grid {
            display: flex;
            flex-wrap: nowrap;
            overflow-x: auto;
            grid-template-columns: none;
        }
        .rx-symbol {
            text-align: center;
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 1rem;
        }
        .prescription-body {
            margin-bottom: 1.5rem;
            flex: 1;
        }
        .body-layout-split {
            display: flex;
            gap: 1.5rem;
            align-items: flex-start;
        }
        .clinical-section {
            flex: 1;
            padding-right: 1rem;
        }
        .medication-section {
            flex: 2;
            padding-left: 1rem;
            border-left: 1px dashed var(--border-color);
        }
        .medical-section {
            margin-bottom: 1.5rem;
        }
        .section-header {
            font-weight: 600;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--primary-color);
        }
        .section-content {
            padding: 0.5rem;
            background-color: transparent;
            border-radius: 4px;
            min-height: 40px;
            font-size: 0.9rem;
            border: 1px solid transparent;
            transition: all 0.2s;
        }
        .section-content:hover {
            border-color: var(--border-color);
            background-color: white;
        }
        .section-content:focus {
            outline: none;
            border-color: var(--secondary-color);
            background-color: white;
        }
        .medication-list {
            list-style: none;
        }
        .medication-item {
            padding: 0.75rem;
            margin-bottom: 0.5rem;
            background-color: transparent;
            border-radius: 4px;
            border: 1px solid var(--border-color);
            transition: all 0.2s;
        }
        .medication-item:hover {
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .medication-format-single {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .medication-format-multi {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }
        .med-name {
            font-weight: 600;
            color: var(--primary-color);
        }
        .med-dose {
            color: var(--text-light);
            font-size: 0.9rem;
        }
        .med-instructions, .med-duration {
            color: var(--text-dark);
            font-size: 0.85rem;
        }
        .prescription-footer {
            padding-top: 1rem;
            border-top: 1px solid var(--border-color);
            background-color: #fafafa;
            margin-top: auto;
            flex-shrink: 0;
        }
        .footer-split {
            display: flex;
            justify-content: space-between;
            gap: 2rem;
        }
        .footer-left, .footer-right {
            flex: 1;
        }
        .footer-line {
            margin-bottom: 0.25rem;
        }
        .watermark {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-45deg);
            font-size: 3rem;
            color: rgba(0, 0, 0, 0.05);
            font-weight: 700;
            pointer-events: none;
            white-space: nowrap;
        }
        .watermark-logo {
            position: absolute;
            pointer-events: none;
            max-width: 50%;
            max-height: 50%;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .bengali-font {
            font-family: 'Noto Sans Bengali', sans-serif;
        }
        .editable {
            cursor: text;
            position: relative;
        }
        .editable:hover {
            background-color: rgba(52, 152, 219, 0.05);
        }
        .edit-indicator {
            position: absolute;
            top: 2px;
            right: 2px;
            font-size: 0.7rem;
            color: var(--secondary-color);
            opacity: 0;
            transition: opacity 0.2s;
        }
        .editable:hover .edit-indicator {
            opacity: 1;
        }
        .notification {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background-color: var(--success-color);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 4px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 1000;
        }
        .notification.show {
            transform: translateY(0);
            opacity: 1;
        }
        .add-medication-btn {
            width: 100%;
            padding: 0.75rem;
            border: 2px dashed var(--border-color);
            background-color: transparent;
            color: var(--text-light);
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }
        .add-medication-btn:hover {
            border-color: var(--secondary-color);
            color: var(--secondary-color);
            background-color: rgba(52, 152, 219, 0.05);
        }
        .line-style-controls {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }
        .line-width-slider {
            flex: 1;
        }
        .medication-line-input {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }
        .medication-line-input input {
            flex: 1;
        }
        .section-reorder {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        .section-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem;
            background-color: #f9f9f9;
            border-radius: 4px;
            border: 1px solid var(--border-color);
        }
        .section-item-handle {
            cursor: move;
            color: var(--text-light);
        }
        .section-item-name {
            flex: 1;
        }
        .section-item-controls {
            display: flex;
            gap: 0.25rem;
        }
        .conditional-section {
            margin-top: 1rem;
        }
        .text-style-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.5rem;
        }
        .measurement-controls {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }
        .measurement-input {
            width: 80px;
        }
        .measurement-unit {
            width: 80px;
        }
        .line-editor {
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 1rem;
            margin-bottom: 1rem;
            background-color: #fafafa;
        }
        .line-editor-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
            font-weight: 600;
        }
        .line-editor-content {
            /* display: flex; */
            /* gap: 1rem; */
        }
        .line-editor-main {
            flex: 2;
        }
        .line-editor-style {
            flex: 1;
        }
        .template-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem;
        }
        .template-card {
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        .template-card:hover {
            border-color: var(--secondary-color);
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .template-preview {
            height: 120px;
            background-color: #f9f9f9;
            border-radius: 4px;
            margin-bottom: 0.5rem;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            color: var(--text-light);
        }
        .template-name {
            font-weight: 500;
            text-align: center;
        }
        .template-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 0.5rem;
            justify-content: center;
        }
        .template-actions .btn {
            padding: 0.25rem 0.5rem;
            font-size: 0.8rem;
        }
        @media (max-width: 1200px) {
            .sidebar {
                width: 350px;
            }
            .page-a4 {
                width: 580px;
                min-height: 820px;
                padding: 40px;
            }
            .page-b4 {
                width: 690px;
                min-height: 975px;
                padding: 48px;
            }
            .page-letter {
                width: 612px;
                min-height: 792px;
                padding: 54px;
            }
            .page-legal {
                width: 612px;
                min-height: 1008px;
                padding: 54px;
            }
            .page-a5 {
                width: 410px;
                min-height: 580px;
                padding: 28px;
            }
            .page-a4.landscape {
                width: 820px;
                min-height: 580px;
            }
            .page-b4.landscape {
                width: 975px;
                min-height: 690px;
            }
            .page-letter.landscape {
                width: 792px;
                min-height: 612px;
            }
            .page-legal.landscape {
                width: 1008px;
                min-height: 612px;
            }
            .page-a5.landscape {
                width: 580px;
                min-height: 410px;
            }
        }
        @media (max-width: 768px) {
            main {
                flex-direction: column;
            }
            .sidebar {
                width: 100%;
                border-right: none;
                border-bottom: 1px solid var(--border-color);
                max-height: 40vh;
            }
            .page-a4, .page-b4, .page-letter, .page-legal, .page-a5,
            .page-a4.landscape, .page-b4.landscape, .page-letter.landscape, .page-legal.landscape, .page-a5.landscape {
                width: 100%;
                max-width: 550px;
                min-height: auto;
                padding: 20px;
            }
            .patient-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <header>
        <h1><i class="fas fa-file-medical"></i> Professional Prescription Pad Designer</h1>
        <div class="header-actions">
            <button class="btn btn-outline" id="backBtn">
                <i class="fas fa-arrow-left"></i> Back to Dashboard
            </button>
            <button class="btn btn-outline" id="resetBtn">
                <i class="fas fa-undo"></i> Reset
            </button>
            <button class="btn btn-primary" id="saveBtn">
                <i class="fas fa-save"></i> Save Design
            </button>
            <button class="btn btn-success" id="downloadBtn">
                <i class="fas fa-download"></i> Download PDF
            </button>
        </div>
    </header>
    <div class="tabs">
        <div class="tab active" data-tab="page"><i class="fas fa-file"></i> Page Settings</div>
        <div class="tab" data-tab="header"><i class="fas fa-heading"></i> Header/Footer</div>
        <div class="tab" data-tab="patient"><i class="fas fa-user-edit"></i> Patient Info</div>
        <div class="tab" data-tab="layout"><i class="fas fa-th-large"></i> Layout</div>
        <div class="tab" data-tab="content"><i class="fas fa-edit"></i> Content</div>
        <div class="tab" data-tab="medication"><i class="fas fa-pills"></i> Medications</div>
        <div class="tab" data-tab="style"><i class="fas fa-palette"></i> Style</div>
        <div class="tab" data-tab="templates"><i class="fas fa-file-alt"></i> Saved Designs</div>
    </div>
    <main>
        <aside class="sidebar">
            <!-- Page Settings Tab -->
            <div class="tab-content active" id="page-tab">
                <h2><i class="fas fa-file"></i> Page Settings</h2>
                <div class="section">
                    <div class="section-title">Page Size</div>
                    <select id="pageSize" class="form-control">
                        <option value="a4">A4 (210 × 297 mm)</option>
                        <option value="b4">B4 (250 × 353 mm)</option>
                        <option value="letter">Letter (8.5 × 11 in)</option>
                        <option value="legal">Legal (8.5 × 14 in)</option>
                        <option value="a5">A5 (148 × 210 mm)</option>
                    </select>
                </div>
                <div class="section">
                    <div class="section-title">Page Orientation</div>
                    <div class="toggle-group">
                        <button class="toggle-btn active" data-orientation="portrait">Portrait</button>
                        <button class="toggle-btn" data-orientation="landscape">Landscape</button>
                    </div>
                </div>
                <div class="section">
                    <div class="section-title">Border Settings</div>
                    <div class="form-group">
                        <label for="borderStyle">Border Style</label>
                        <select id="borderStyle" class="form-control">
                            <option value="standard">Standard</option>
                            <option value="double">Double</option>
                            <option value="dashed">Dashed</option>
                            <option value="none">None</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Border Size</label>
                        <div class="measurement-controls">
                            <input type="number" id="borderSize" class="form-control measurement-input" value="1" min="0" max="10" step="0.1">
                            <select id="borderUnit" class="form-control measurement-unit">
                                <option value="px">px</option>
                                <option value="mm">mm</option>
                                <option value="cm">cm</option>
                                <option value="in">in</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="section">
                    <div class="section-title">Margin Settings</div>
                    <div class="form-group">
                        <label>Top Margin</label>
                        <div class="measurement-controls">
                            <input type="number" id="marginTop" class="form-control measurement-input" value="15" min="0" max="50" step="0.1">
                            <select id="marginUnitTop" class="form-control measurement-unit">
                                <option value="mm">mm</option>
                                <option value="cm">cm</option>
                                <option value="in">in</option>
                                <option value="px">px</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Bottom Margin</label>
                        <div class="measurement-controls">
                            <input type="number" id="marginBottom" class="form-control measurement-input" value="15" min="0" max="50" step="0.1">
                            <select id="marginUnitBottom" class="form-control measurement-unit">
                                <option value="mm">mm</option>
                                <option value="cm">cm</option>
                                <option value="in">in</option>
                                <option value="px">px</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Left Margin</label>
                        <div class="measurement-controls">
                            <input type="number" id="marginLeft" class="form-control measurement-input" value="15" min="0" max="50" step="0.1">
                            <select id="marginUnitLeft" class="form-control measurement-unit">
                                <option value="mm">mm</option>
                                <option value="cm">cm</option>
                                <option value="in">in</option>
                                <option value="px">px</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Right Margin</label>
                        <div class="measurement-controls">
                            <input type="number" id="marginRight" class="form-control measurement-input" value="15" min="0" max="50" step="0.1">
                            <select id="marginUnitRight" class="form-control measurement-unit">
                                <option value="mm">mm</option>
                                <option value="cm">cm</option>
                                <option value="in">in</option>
                                <option value="px">px</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="section">
                    <div class="section-title">Header/Footer Size</div>
                    <div class="form-group">
                        <label>Header Height</label>
                        <div class="measurement-controls">
                            <input type="number" id="headerHeight" class="form-control measurement-input" value="15" min="0" max="50" step="0.1">
                            <select id="headerUnit" class="form-control measurement-unit">
                                <option value="mm">mm</option>
                                <option value="cm">cm</option>
                                <option value="in">in</option>
                                <option value="px">px</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Footer Height</label>
                        <div class="measurement-controls">
                            <input type="number" id="footerHeight" class="form-control measurement-input" value="15" min="0" max="50" step="0.1">
                            <select id="footerUnit" class="form-control measurement-unit">
                                <option value="mm">mm</option>
                                <option value="cm">cm</option>
                                <option value="in">in</option>
                                <option value="px">px</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Other tabs remain the same as your original file -->
            <!-- Header/Footer Tab -->
            <div class="tab-content" id="header-tab">
                <h2><i class="fas fa-heading"></i> Header & Footer Settings</h2>
                <div class="section">
                    <div class="section-title">Header Layout</div>
                    <div class="toggle-group">
                        <button class="toggle-btn active" data-header-layout="split">Split</button>
                        <button class="toggle-btn" data-header-layout="centered">Centered</button>
                        <button class="toggle-btn" data-header-layout="left">Left Aligned</button>
                    </div>
                </div>
                <div class="section">
                    <div class="section-title">Background Colors</div>
                    <div class="form-group">
                        <label for="headerBgColor">Header Background Color</label>
                        <div class="color-picker-wrapper">
                            <input type="color" id="headerBgColor" class="color-picker" value="#fafafa">
                            <input type="text" id="headerBgColorValue" class="form-control color-value" value="#fafafa">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="footerBgColor">Footer Background Color</label>
                        <div class="color-picker-wrapper">
                            <input type="color" id="footerBgColor" class="color-picker" value="#fafafa">
                            <input type="text" id="footerBgColorValue" class="form-control color-value" value="#fafafa">
                        </div>
                    </div>
                </div>
                <div class="section">
                    <div class="section-title">Header Line Editor</div>
                    <div class="line-editor">
                        <div class="line-editor-header">
                            <span>Header Left Lines</span>
                            <button class="btn-icon" onclick="addHeaderLine('Left')"><i class="fas fa-plus"></i></button>
                        </div>
                        <div id="headerLeftLineEditors"></div>
                    </div>
                    <div class="line-editor">
                        <div class="line-editor-header">
                            <span>Header Right Lines</span>
                            <button class="btn-icon" onclick="addHeaderLine('Right')"><i class="fas fa-plus"></i></button>
                        </div>
                        <div id="headerRightLineEditors"></div>
                    </div>
                </div>
                <div class="section">
                    <div class="section-title">Header Separator Line</div>
                    <div class="form-group">
                        <label for="headerLineStyle">Line Style</label>
                        <select id="headerLineStyle" class="form-control">
                            <option value="solid">Solid</option>
                            <option value="dashed">Dashed</option>
                            <option value="dotted">Dotted</option>
                            <option value="double">Double</option>
                            <option value="none">None</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Line Width</label>
                        <div class="measurement-controls">
                            <input type="number" id="headerLineWidth" class="form-control measurement-input" value="1" min="0.5" max="10" step="0.1">
                            <select id="headerLineWidthUnit" class="form-control measurement-unit">
                                <option value="px">px</option>
                                <option value="mm">mm</option>
                                <option value="cm">cm</option>
                                <option value="in">in</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="headerLineColor">Line Color</label>
                        <div class="color-picker-wrapper">
                            <input type="color" id="headerLineColor" class="color-picker" value="#ddd">
                            <input type="text" id="headerLineColorValue" class="form-control color-value" value="#ddd">
                        </div>
                    </div>
                </div>
                <div class="section">
                    <div class="section-title">Footer Layout</div>
                    <div class="toggle-group">
                        <button class="toggle-btn active" data-footer-layout="split">Split</button>
                        <button class="toggle-btn" data-footer-layout="centered">Centered</button>
                        <button class="toggle-btn" data-footer-layout="none">None</button>
                    </div>
                </div>
                <div class="section">
                    <div class="section-title">Footer Line Editor</div>
                    <div class="line-editor">
                        <div class="line-editor-header">
                            <span>Footer Left Lines</span>
                            <button class="btn-icon" onclick="addFooterLine('Left')"><i class="fas fa-plus"></i></button>
                        </div>
                        <div id="footerLeftLineEditors"></div>
                    </div>
                    <div class="line-editor">
                        <div class="line-editor-header">
                            <span>Footer Right Lines</span>
                            <button class="btn-icon" onclick="addFooterLine('Right')"><i class="fas fa-plus"></i></button>
                        </div>
                        <div id="footerRightLineEditors"></div>
                    </div>
                </div>
                <div class="section">
                    <div class="section-title">Footer Separator Line</div>
                    <div class="form-group">
                        <label for="footerLineStyle">Line Style</label>
                        <select id="footerLineStyle" class="form-control">
                            <option value="solid">Solid</option>
                            <option value="dashed">Dashed</option>
                            <option value="dotted">Dotted</option>
                            <option value="double">Double</option>
                            <option value="none">None</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Line Width</label>
                        <div class="measurement-controls">
                            <input type="number" id="footerLineWidth" class="form-control measurement-input" value="1" min="0.5" max="10" step="0.1">
                            <select id="footerLineWidthUnit" class="form-control measurement-unit">
                                <option value="px">px</option>
                                <option value="mm">mm</option>
                                <option value="cm">cm</option>
                                <option value="in">in</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="footerLineColor">Line Color</label>
                        <div class="color-picker-wrapper">
                            <input type="color" id="footerLineColor" class="color-picker" value="#ddd">
                            <input type="text" id="footerLineColorValue" class="form-control color-value" value="#ddd">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Patient Info Tab -->
            <div class="tab-content" id="patient-tab">
                <h2><i class="fas fa-user-edit"></i> Patient Info Settings</h2>
                <div class="section">
                    <div class="section-title">Visible Fields</div>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="showPatientName" checked>
                            <label for="showPatientName">Name</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="showPatientAge" checked>
                            <label for="showPatientAge">Age</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="showPatientSex" checked>
                            <label for="showPatientSex">Sex</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="showPatientWeight" checked>
                            <label for="showPatientWeight">Weight</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="showPatientId" checked>
                            <label for="showPatientId">Patient ID</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="showPatientDate" checked>
                            <label for="showPatientDate">Date</label>
                        </div>
                    </div>
                </div>
                <div class="section">
                    <div class="section-title">Layout Style</div>
                    <div class="toggle-group">
                        <button class="toggle-btn" data-patient-layout="single">Single Line</button>
                        <button class="toggle-btn active" data-patient-layout="double">Double Line</button>
                    </div>
                </div>
                <div class="section">
                    <div class="section-title">Font Size</div>
                    <div class="form-group">
                        <label>Label Font Size</label>
                        <div class="measurement-controls">
                            <input type="number" id="patientLabelSize" class="form-control measurement-input" value="0.8" min="0.5" max="2" step="0.1">
                            <select id="patientLabelSizeUnit" class="form-control measurement-unit">
                                <option value="rem">rem</option>
                                <option value="px">px</option>
                                <option value="pt">pt</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Input Font Size</label>
                        <div class="measurement-controls">
                            <input type="number" id="patientInputSize" class="form-control measurement-input" value="0.9" min="0.5" max="2" step="0.1">
                            <select id="patientInputSizeUnit" class="form-control measurement-unit">
                                <option value="rem">rem</option>
                                <option value="px">px</option>
                                <option value="pt">pt</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="section">
                    <div class="section-title">Spacing</div>
                    <div class="form-group">
                        <label>Field Item Spacing (Label-Input)</label>
                        <div class="measurement-controls">
                            <input type="number" id="patientFieldItemSpacing" class="form-control measurement-input" value="0.5" min="0" max="2" step="0.1">
                            <select id="patientFieldItemSpacingUnit" class="form-control measurement-unit">
                                <option value="rem">rem</option>
                                <option value="px">px</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Field Spacing (Between Fields)</label>
                        <div class="measurement-controls">
                            <input type="number" id="patientFieldSpacing" class="form-control measurement-input" value="1" min="0" max="2" step="0.1">
                            <select id="patientFieldSpacingUnit" class="form-control measurement-unit">
                                <option value="rem">rem</option>
                                <option value="px">px</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Layout Tab -->
            <div class="tab-content" id="layout-tab">
                <h2><i class="fas fa-th-large"></i> Layout Options</h2>
                <div class="section">
                    <div class="section-title">Patient Information</div>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="showPatientInfo" checked>
                            <label for="showPatientInfo">Show Patient Info Section</label>
                        </div>
                    </div>
                </div>
                <div class="section">
                    <div class="section-title">Spacing</div>
                    <div class="form-group">
                        <label>Spacing below Patient Info</label>
                        <div class="measurement-controls">
                            <input type="number" id="patientInfoSpacing" class="form-control measurement-input" value="1.5" min="0" max="5" step="0.1">
                            <select id="patientInfoSpacingUnit" class="form-control measurement-unit">
                                <option value="rem">rem</option>
                                <option value="px">px</option>
                                <option value="mm">mm</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="section">
                    <div class="section-title">Body Layout</div>
                    <div class="toggle-group">
                        <button class="toggle-btn active" data-body-layout="single">Single Column</button>
                        <button class="toggle-btn" data-body-layout="split">Split (1/3 - 2/3)</button>
                    </div>
                </div>
                <div class="section">
                    <div class="section-title">RX Symbol</div>
                    <div class="toggle-group">
                        <button class="toggle-btn active" data-rx="standard">Standard ℞</button>
                        <button class="toggle-btn" data-rx="modern">Modern Rx</button>
                        <button class="toggle-btn" data-rx="none">None</button>
                    </div>
                    <div class="form-group">
                        <label>Symbol Size</label>
                        <div class="measurement-controls">
                            <input type="number" id="rxSymbolSize" class="form-control measurement-input" value="3" min="1" max="6" step="0.1">
                            <select id="rxSymbolSizeUnit" class="form-control measurement-unit">
                                <option value="rem">rem</option>
                                <option value="em">em</option>
                                <option value="px">px</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="section" id="splitLayoutSpacing" style="display: none;">
                    <div class="section-title">Split Layout Spacing</div>
                    <div class="form-group">
                        <label>Left Side Top Spacing</label>
                        <div class="measurement-controls">
                            <input type="number" id="splitLeftSpacing" class="form-control measurement-input" value="0" min="0" max="50" step="1">
                            <select id="splitLeftSpacingUnit" class="form-control measurement-unit">
                                <option value="px">px</option>
                                <option value="rem">rem</option>
                                <option value="mm">mm</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Right Side Top Spacing</label>
                        <div class="measurement-controls">
                            <input type="number" id="splitRightSpacing" class="form-control measurement-input" value="0" min="0" max="50" step="1">
                            <select id="splitRightSpacingUnit" class="form-control measurement-unit">
                                <option value="px">px</option>
                                <option value="rem">rem</option>
                                <option value="mm">mm</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="section">
                    <div class="section-title">Logo Position</div>
                    <select id="logoPosition" class="form-control">
                        <option value="header-right">Header Right</option>
                        <option value="header-left">Header Left</option>
                        <option value="header-center">Header Center</option>
                        <option value="none">None</option>
                    </select>
                </div>
                <div class="section">
                    <label for="logoUpload">Upload Logo</label>
                    <input type="file" id="logoUpload" class="form-control" accept="image/*">
                </div>
            </div>

            <!-- Content Tab -->
            <div class="tab-content" id="content-tab">
                <h2><i class="fas fa-edit"></i> Content Sections</h2>
                <div class="section">
                    <div class="section-title">Section Order</div>
                    <div class="section-reorder" id="sectionReorder">
                        <div class="section-item" data-section="ccSection">
                            <div class="section-item-handle"><i class="fas fa-grip-vertical"></i></div>
                            <div class="section-item-name">C/C (Chief Complaints)</div>
                            <div class="section-item-controls">
                                <button class="btn-icon" onclick="moveSectionUp('ccSection')"><i class="fas fa-arrow-up"></i></button>
                                <button class="btn-icon" onclick="moveSectionDown('ccSection')"><i class="fas fa-arrow-down"></i></button>
                            </div>
                        </div>
                        <div class="section-item" data-section="dhSection">
                            <div class="section-item-handle"><i class="fas fa-grip-vertical"></i></div>
                            <div class="section-item-name">D/H (Drug History)</div>
                            <div class="section-item-controls">
                                <button class="btn-icon" onclick="moveSectionUp('dhSection')"><i class="fas fa-arrow-up"></i></button>
                                <button class="btn-icon" onclick="moveSectionDown('dhSection')"><i class="fas fa-arrow-down"></i></button>
                            </div>
                        </div>
                        <div class="section-item" data-section="oeSection">
                            <div class="section-item-handle"><i class="fas fa-grip-vertical"></i></div>
                            <div class="section-item-name">O/E (On Examination)</div>
                            <div class="section-item-controls">
                                <button class="btn-icon" onclick="moveSectionUp('oeSection')"><i class="fas fa-arrow-up"></i></button>
                                <button class="btn-icon" onclick="moveSectionDown('oeSection')"><i class="fas fa-arrow-down"></i></button>
                            </div>
                        </div>
                        <div class="section-item" data-section="invSection">
                            <div class="section-item-handle"><i class="fas fa-grip-vertical"></i></div>
                            <div class="section-item-name">INV (Investigations)</div>
                            <div class="section-item-controls">
                                <button class="btn-icon" onclick="moveSectionUp('invSection')"><i class="fas fa-arrow-up"></i></button>
                                <button class="btn-icon" onclick="moveSectionDown('invSection')"><i class="fas fa-arrow-down"></i></button>
                            </div>
                        </div>
                        <div class="section-item" data-section="advSection">
                            <div class="section-item-handle"><i class="fas fa-grip-vertical"></i></div>
                            <div class="section-item-name">Adv (Advice)</div>
                            <div class="section-item-controls">
                                <button class="btn-icon" onclick="moveSectionUp('advSection')"><i class="fas fa-arrow-up"></i></button>
                                <button class="btn-icon" onclick="moveSectionDown('advSection')"><i class="fas fa-arrow-down"></i></button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="section">
                    <div class="section-title">Include Sections</div>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="includeCC" checked>
                            <label for="includeCC">C/C (Chief Complaints)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="includeDH" checked>
                            <label for="includeDH">D/H (Drug History)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="includeOE" checked>
                            <label for="includeOE">O/E (On Examination)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="includeINV" checked>
                            <label for="includeINV">INV (Investigations)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="includeAdv" checked>
                            <label for="includeAdv">Adv (Advice)</label>
                        </div>
                    </div>
                </div>
                <div class="section">
                    <div class="section-title">Section Labels</div>
                    <div class="form-group">
                        <label for="ccLabel">C/C Label</label>
                        <input type="text" id="ccLabel" class="form-control" value="C/C:">
                    </div>
                    <div class="form-group">
                        <label for="dhLabel">D/H Label</label>
                        <input type="text" id="dhLabel" class="form-control" value="D/H:">
                    </div>
                    <div class="form-group">
                        <label for="oeLabel">O/E Label</label>
                        <input type="text" id="oeLabel" class="form-control" value="O/E:">
                    </div>
                    <div class="form-group">
                        <label for="invLabel">INV Label</label>
                        <input type="text" id="invLabel" class="form-control" value="INV:">
                    </div>
                    <div class="form-group">
                        <label for="advLabel">Adv Label</label>
                        <input type="text" id="advLabel" class="form-control" value="Adv:">
                    </div>
                </div>
                <div class="section">
                    <div class="section-title">Default Content</div>
                    <div class="form-group">
                        <label for="ccDefault">C/C Default Text</label>
                        <textarea id="ccDefault" class="form-control">Feeling excessively warm
palpitations</textarea>
                    </div>
                    <div class="form-group">
                        <label for="dhDefault">D/H Default Text</label>
                        <textarea id="dhDefault" class="form-control">Tab. Chear 50 mg
Tab. Indever 20 mg
Tab. Norium 10 mg</textarea>
                    </div>
                </div>
                <div class="section">
                    <div class="section-title">Content Font Size</div>
                    <div class="form-group">
                        <label>Font Size</label>
                        <div class="measurement-controls">
                            <input type="number" id="contentFontSize" class="form-control measurement-input" value="14" min="8" max="32">
                            <select id="contentFontSizeUnit" class="form-control measurement-unit">
                                <option value="px">px</option>
                                <option value="pt">pt</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Medication Tab -->
            <div class="tab-content" id="medication-tab">
                <h2><i class="fas fa-pills"></i> Medication Settings</h2>
                <div class="section">
                    <div class="section-title">Medication Format</div>
                    <div class="toggle-group">
                        <button class="toggle-btn active" data-med-format="single">Single Line</button>
                        <button class="toggle-btn" data-med-format="multi">Multi Line</button>
                        <button class="toggle-btn" data-med-format="table">Table</button>
                    </div>
                </div>
                <div class="section" id="multiLineConfig" style="display: none;">
                    <div class="section-title">Multi-line Layout</div>
                    <div class="form-group">
                        <label for="multiLineCount">Number of lines per medication</label>
                        <input type="number" id="multiLineCount" class="form-control" value="2" min="1" max="4">
                    </div>
                    <div id="multiLineOptions"></div>
                </div>
                <div class="section">
                    <div class="section-title">Medication Details</div>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="showMedName" checked>
                            <label for="showMedName">Medication Name</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="showMedDose" checked>
                            <label for="showMedDose">Dose</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="showMedDuration" checked>
                            <label for="showMedDuration">Duration</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="showMedInstructions" checked>
                            <label for="showMedInstructions">Instructions</label>
                        </div>
                    </div>
                </div>
                <div class="section">
                    <div class="section-title">Medication Lines</div>
                    <div class="form-group">
                        <label for="medicationLines">Number of Lines</label>
                        <select id="medicationLines" class="form-control">
                            <option value="3">3 Lines</option>
                            <option value="5">5 Lines</option>
                            <option value="8">8 Lines</option>
                            <option value="10">10 Lines</option>
                        </select>
                    </div>
                    <div id="medicationLineInputs">
                        <div class="medication-line-input">
                            <input type="text" class="form-control med-line-content" data-line="1" value="Tab. Carbizol 5 mg - ৩+৩+৩ - খাবার পর - ৪ সপ্তাহ">
                        </div>
                        <div class="medication-line-input">
                            <input type="text" class="form-control med-line-content" data-line="2" value="Tab. Chear 50 mg - ১+০+১ - খাবার পর">
                        </div>
                        <div class="medication-line-input">
                            <input type="text" class="form-control med-line-content" data-line="3" value="Tab. Indever 20 mg - ১+০+১ - খাবার পর">
                        </div>
                    </div>
                </div>
                <div class="section">
                    <div class="section-title">Medication Text Styles</div>
                    <div class="line-editor">
                        <div class="line-editor-header"><span>Medicine Name</span></div>
                        <div class="form-group">
                            <label>Font Size</label>
                            <div class="measurement-controls">
                                <input type="number" id="medNameSize" class="form-control measurement-input" value="16" min="8" max="32">
                                <select id="medNameSizeUnit" class="form-control measurement-unit"><option value="px">px</option><option value="pt">pt</option></select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Style</label>
                            <select id="medNameStyle" class="form-control"><option value="normal">Normal</option><option value="bold">Bold</option><option value="italic">Italic</option></select>
                        </div>
                    </div>
                    <div class="line-editor">
                        <div class="line-editor-header"><span>Dosage</span></div>
                        <div class="form-group">
                            <label>Font Size</label>
                            <div class="measurement-controls">
                                <input type="number" id="medDoseSize" class="form-control measurement-input" value="14" min="8" max="32">
                                <select id="medDoseSizeUnit" class="form-control measurement-unit"><option value="px">px</option><option value="pt">pt</option></select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Style</label>
                            <select id="medDoseStyle" class="form-control"><option value="normal">Normal</option><option value="bold">Bold</option><option value="italic">Italic</option></select>
                        </div>
                    </div>
                    <div class="line-editor">
                        <div class="line-editor-header"><span>Instructions</span></div>
                        <div class="form-group">
                            <label>Font Size</label>
                            <div class="measurement-controls">
                                <input type="number" id="medInstrSize" class="form-control measurement-input" value="13" min="8" max="32">
                                <select id="medInstrSizeUnit" class="form-control measurement-unit"><option value="px">px</option><option value="pt">pt</option></select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Style</label>
                            <select id="medInstrStyle" class="form-control"><option value="normal">Normal</option><option value="bold">Bold</option><option value="italic">Italic</option></select>
                        </div>
                    </div>
                    <div class="line-editor">
                        <div class="line-editor-header"><span>Duration</span></div>
                        <div class="form-group">
                            <label>Font Size</label>
                            <div class="measurement-controls">
                                <input type="number" id="medDurSize" class="form-control measurement-input" value="13" min="8" max="32">
                                <select id="medDurSizeUnit" class="form-control measurement-unit"><option value="px">px</option><option value="pt">pt</option></select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Style</label>
                            <select id="medDurStyle" class="form-control"><option value="normal">Normal</option><option value="bold">Bold</option><option value="italic">Italic</option></select>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Style Tab -->
            <div class="tab-content" id="style-tab">
                <h2><i class="fas fa-palette"></i> Style Options</h2>
                <div class="section">
                    <div class="section-title">Colors</div>
                    <div class="form-group">
                        <label for="pageBgColor">Page Background Color</label>
                        <div class="color-picker-wrapper">
                            <input type="color" id="pageBgColor" class="color-picker" value="#ffffff">
                            <input type="text" id="pageBgColorValue" class="form-control color-value" value="#ffffff">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="contentBgColor">Content Area Background Color</label>
                        <div class="color-picker-wrapper">
                            <input type="color" id="contentBgColor" class="color-picker" value="#ffffff">
                            <input type="text" id="contentBgColorValue" class="form-control color-value" value="#ffffff">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="headerColor">Header Color</label>
                        <div class="color-picker-wrapper">
                            <input type="color" id="headerColor" class="color-picker" value="#2c3e50">
                            <input type="text" id="headerColorValue" class="form-control color-value" value="#2c3e50">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="titleColor">Title Color</label>
                        <div class="color-picker-wrapper">
                            <input type="color" id="titleColor" class="color-picker" value="#2c3e50">
                            <input type="text" id="titleColorValue" class="form-control color-value" value="#2c3e50">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="accentColor">Accent Color</label>
                        <div class="color-picker-wrapper">
                            <input type="color" id="accentColor" class="color-picker" value="#3498db">
                            <input type="text" id="accentColorValue" class="form-control color-value" value="#3498db">
                        </div>
                    </div>
                </div>
                <div class="section">
                    <div class="section-title">Fonts</div>
                    <div class="form-group">
                        <label for="fontFamily">Primary Font</label>
                        <select id="fontFamily" class="form-control">
                            <option value="'Segoe UI', Tahoma, Geneva, Verdana, sans-serif">Segoe UI</option>
                            <option value="Arial, Helvetica, sans-serif">Arial</option>
                            <option value="'Times New Roman', Times, serif">Times New Roman</option>
                            <option value="Georgia, serif">Georgia</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="bengaliFont">Bengali Font</label>
                        <select id="bengaliFont" class="form-control">
                            <option value="'Noto Sans Bengali', sans-serif">Noto Sans Bengali</option>
                            <option value="'Kalpurush', sans-serif">Kalpurush</option>
                            <option value="'Siyam Rupali', sans-serif">Siyam Rupali</option>
                        </select>
                    </div>
                </div>
                <div class="section">
                    <div class="section-title">Watermark</div>
                    <div class="form-group">
                        <label for="watermark">Watermark Text</label>
                        <input type="text" id="watermark" class="form-control" placeholder="e.g. Medical Center">
                    </div>
                </div>
                <div class="section">
                    <div class="section-title">Watermark Logo</div>
                    <div class="form-group">
                        <label for="watermarkLogoUpload">Upload Logo</label>
                        <input type="file" id="watermarkLogoUpload" class="form-control" accept="image/*">
                    </div>
                    <div class="form-group">
                        <label for="watermarkLogoPosition">Position</label>
                        <select id="watermarkLogoPosition" class="form-control">
                            <option value="center">Center</option>
                            <option value="top-left">Top Left</option>
                            <option value="top-right">Top Right</option>
                            <option value="bottom-left">Bottom Left</option>
                            <option value="bottom-right">Bottom Right</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="watermarkLogoOpacity">Opacity</label>
                        <input type="range" id="watermarkLogoOpacity" class="form-control" min="0" max="1" step="0.05" value="0.1">
                    </div>
                </div>
            </div>

            <!-- Saved Designs Tab -->
            <div class="tab-content" id="templates-tab">
                <h2><i class="fas fa-file-alt"></i> Saved Designs</h2>
                <div class="section">
                    <div class="section-title">Your Saved Designs</div>
                    <div class="template-grid" id="savedDesignsGrid">
                        <!-- Designs will be loaded here dynamically -->
                        <div class="template-preview">
                            <i class="fas fa-spinner fa-spin"></i>
                            <div>Loading designs...</div>
                        </div>
                    </div>
                </div>
                <div class="section">
                    <div class="section-title">Quick Templates</div>
                    <div class="template-grid">
                        <div class="template-card" onclick="loadQuickTemplate('standard')">
                            <div class="template-preview">
                                <i class="fas fa-file-medical fa-3x"></i>
                            </div>
                            <div class="template-name">Standard Prescription</div>
                        </div>
                        <div class="template-card" onclick="loadQuickTemplate('minimal')">
                            <div class="template-preview">
                                <i class="fas fa-clipboard fa-3x"></i>
                            </div>
                            <div class="template-name">Minimal Prescription</div>
                        </div>
                    </div>
                </div>
            </div>
        </aside>
        <div class="preview-container">
            <div class="preview-header">
                <h3>Live Preview</h3>
                <div class="page-info">
                    <i class="fas fa-file"></i>
                    <span id="currentPageSize">A4 - Portrait</span>
                </div>
                <div class="zoom-controls">
                    <button class="zoom-btn" id="zoomOut"><i class="fas fa-minus"></i></button>
                    <span class="zoom-value" id="zoomValue">100%</span>
                    <button class="zoom-btn" id="zoomIn"><i class="fas fa-plus"></i></button>
                </div>
            </div>
            <div class="prescription-pad page-a4" id="prescriptionPad">
                <div class="watermark" id="watermarkElement"></div>
                <img id="watermarkLogoElement" class="watermark-logo" src="" alt="Watermark Logo" style="display: none;">
                <div class="prescription-header" id="prescriptionHeader">
                    <div class="header-split" id="headerSplit">
                        <div class="header-left" id="headerLeft">
                            <div class="header-line" id="headerLeftLine1Element">Dr. Abdullah Al Noman</div>
                            <div class="header-line" id="headerLeftLine2Element">MBBS (DU), CMU</div>
                            <div class="header-line" id="headerLeftLine3Element">BMDC Reg. No.- A 137349</div>
                        </div>
                        <div class="header-right" id="headerRight">
                            <div class="header-line" id="headerRightLine1Element"></div>
                            <div class="header-line" id="headerRightLine2Element"></div>
                            <div class="header-line" id="headerRightLine3Element"></div>
                        </div>
                    </div>
                    <div class="logo-container" id="logoContainer" style="display: none;">
                        <div class="logo-placeholder">
                            <i class="fas fa-user-md fa-3x"></i>
                            <div>Logo</div>
                        </div>
                    </div>
                </div>
                <div class="patient-info">
                    <div class="patient-grid">
                        <div class="patient-field">
                            <label>Name</label>
                            <input type="text" id="patientName" placeholder="Patient's Name">
                        </div>
                        <div class="patient-field">
                            <label>Age</label>
                            <input type="text" id="patientAge" placeholder="Age">
                        </div>
                        <div class="patient-field">
                            <label>Sex</label>
                            <input type="text" id="patientSex" placeholder="Sex">
                        </div>
                        <div class="patient-field" id="patientWeightContainer">
                            <label>Wt</label>
                            <input type="text" id="patientWeight" placeholder="Weight">
                        </div>
                        <div class="patient-field">
                            <label>Date</label>
                            <input type="text" id="currentDate" readonly>
                        </div>
                    </div>
                </div>
                <div class="rx-symbol" id="rxSymbol">℞</div>
                <div class="prescription-body body-layout-single" id="prescriptionBody">
                    <div class="clinical-section" id="clinicalSection">
                        <div class="patient-field" id="patientIdContainer" style="display: none; margin-bottom: 1rem;">
                            <label>Patient ID</label>
                            <input type="text" id="patientId" placeholder="Patient's ID/Reg. No.">
                        </div>
                        <div class="medical-section" id="ccSection">
                            <div class="section-header" id="ccLabelElement">C/C:</div>
                            <div class="section-content editable" contenteditable="true" id="ccContent">
                                Feeling excessively warm<br>
                                palpitations
                            </div>
                        </div>
                        <div class="medical-section" id="dhSection">
                            <div class="section-header" id="dhLabelElement">D/H:</div>
                            <div class="section-content editable" contenteditable="true" id="dhContent">
                                Tab. Chear 50 mg<br>
                                Tab. Indever 20 mg<br>
                                Tab. Norium 10 mg
                            </div>
                        </div>
                        <div class="medical-section" id="oeSection">
                            <div class="section-header" id="oeLabelElement">O/E:</div>
                            <div class="section-content editable" contenteditable="true" id="oeContent"></div>
                        </div>
                        <div class="medical-section" id="invSection">
                            <div class="section-header" id="invLabelElement">INV:</div>
                            <div class="section-content editable" contenteditable="true" id="invContent">
                                TSH - 0.37 mIU/mL (21/08/25)<br>
                                1) TSH<br>
                                2) T4
                            </div>
                        </div>
                        <div class="medical-section" id="advSection">
                            <div class="section-header" id="advLabelElement">Adv:</div>
                            <div class="section-content editable" contenteditable="true" id="advContent">
                                <div class="bengali-font">৪ সপ্তাহ পর পুনরায় দেখাবেন।</div>
                            </div>
                        </div>
                    </div>
                    <div class="medication-section" id="medicationSection">
                        <ul class="medication-list" id="medicationList">
                            <li class="medication-item medication-format-single" id="med1">
                                <div class="med-name">Tab. Carbizol 5 mg</div>
                                <div class="med-dose">৩+৩+৩</div>
                                <div class="med-instructions">খাবার পর - ৪ সপ্তাহ</div>
                            </li>
                            <li class="medication-item medication-format-single" id="med2">
                                <div class="med-name">Tab. Chear 50 mg</div>
                                <div class="med-dose">১+০+১</div>
                                <div class="med-instructions">খাবার পর</div>
                            </li>
                            <li class="medication-item medication-format-single" id="med3">
                                <div class="med-name">Tab. Indever 20 mg</div>
                                <div class="med-dose">১+০+১</div>
                                <div class="med-instructions">খাবার পর</div>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="prescription-footer" id="prescriptionFooter">
                    <div class="footer-split" id="footerSplit">
                        <div class="footer-left" id="footerLeft">
                            <div class="footer-line" id="footerLeftLine1Element">ডাঃ আবদুল্লাহ আল নোমান</div>
                            <div class="footer-line" id="footerLeftLine2Element">বাজার রোড, রামপুরা ঢাকা-১২১৯</div>
                        </div>
                        <div class="footer-right" id="footerRight">
                            <div class="footer-line" id="footerRightLine1Element">বিকাল ৪টা - রাত ৮টা</div>
                            <div class="footer-line" id="footerRightLine2Element">মোবাইলঃ ০১৬২৩-৬০৩৬৮০</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <div class="notification" id="notification">
        <i class="fas fa-check-circle"></i>
        <span id="notificationText">Changes saved successfully!</span>
    </div>

    <script>
        // API Integration Functions
        const API_BASE = window.location.origin;

        // Save design to backend
        async function saveDesignToBackend() {
            const designData = getCurrentDesignData();
            const name = prompt('Enter a name for this pad design:');
            
            if (!name) return;
            
            try {
                const response = await fetch(`${API_BASE}/api/pad-designs`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        name: name,
                        designData: designData
                    })
                });
                
                if (response.ok) {
                    showNotification('Pad design saved to server!');
                    loadSavedDesigns();
                } else {
                    throw new Error('Failed to save design');
                }
            } catch (error) {
                console.error('Error saving design:', error);
                showNotification('Error saving design to server');
            }
        }

        // Load saved designs from backend
        async function loadSavedDesigns() {
            try {
                const response = await fetch(`${API_BASE}/api/pad-designs`);
                const designs = await response.json();
                updateDesignsList(designs);
            } catch (error) {
                console.error('Error loading designs:', error);
                showNotification('Error loading designs from server');
            }
        }

        // Load a specific design
        async function loadDesignFromBackend(designId) {
            try {
                const response = await fetch(`${API_BASE}/api/pad-designs/${designId}`);
                const design = await response.json();
                
                if (design) {
                    applyDesignData(design.designData);
                    showNotification(`Design "${design.name}" loaded!`);
                }
            } catch (error) {
                console.error('Error loading design:', error);
                showNotification('Error loading design');
            }
        }

        // Delete a design
        async function deleteDesignFromBackend(designId, designName) {
            if (!confirm(`Are you sure you want to delete "${designName}"?`)) return;
            
            try {
                const response = await fetch(`${API_BASE}/api/pad-designs/${designId}`, {
                    method: 'DELETE'
                });
                
                if (response.ok) {
                    showNotification('Design deleted successfully');
                    loadSavedDesigns();
                }
            } catch (error) {
                console.error('Error deleting design:', error);
                showNotification('Error deleting design');
            }
        }

        // Get current design data
        function getCurrentDesignData() {
            return {
                // Page Settings
                pageSize: document.getElementById('pageSize').value,
                orientation: document.querySelector('[data-orientation].active').dataset.orientation,
                borderStyle: document.getElementById('borderStyle').value,
                borderSize: document.getElementById('borderSize').value,
                borderUnit: document.getElementById('borderUnit').value,
                
                // Header/Footer
                headerLayout: document.querySelector('[data-header-layout].active').dataset.headerLayout,
                footerLayout: document.querySelector('[data-footer-layout].active').dataset.footerLayout,
                headerBgColor: document.getElementById('headerBgColor').value,
                footerBgColor: document.getElementById('footerBgColor').value,
                
                // Patient Info
                patientLayout: document.querySelector('[data-patient-layout].active').dataset.patientLayout,
                showPatientName: document.getElementById('showPatientName').checked,
                showPatientAge: document.getElementById('showPatientAge').checked,
                showPatientSex: document.getElementById('showPatientSex').checked,
                showPatientWeight: document.getElementById('showPatientWeight').checked,
                showPatientId: document.getElementById('showPatientId').checked,
                showPatientDate: document.getElementById('showPatientDate').checked,
                
                // Layout
                bodyLayout: document.querySelector('[data-body-layout].active').dataset.bodyLayout,
                rxSymbol: document.querySelector('[data-rx].active').dataset.rx,
                logoPosition: document.getElementById('logoPosition').value,
                
                // Content
                includeCC: document.getElementById('includeCC').checked,
                includeDH: document.getElementById('includeDH').checked,
                includeOE: document.getElementById('includeOE').checked,
                includeINV: document.getElementById('includeINV').checked,
                includeAdv: document.getElementById('includeAdv').checked,
                
                // Medications
                medFormat: document.querySelector('[data-med-format].active').dataset.medFormat,
                showMedName: document.getElementById('showMedName').checked,
                showMedDose: document.getElementById('showMedDose').checked,
                showMedInstructions: document.getElementById('showMedInstructions').checked,
                showMedDuration: document.getElementById('showMedDuration').checked,
                
                // Style
                pageBgColor: document.getElementById('pageBgColor').value,
                contentBgColor: document.getElementById('contentBgColor').value,
                headerColor: document.getElementById('headerColor').value,
                accentColor: document.getElementById('accentColor').value,
                fontFamily: document.getElementById('fontFamily').value,
                bengaliFont: document.getElementById('bengaliFont').value,
                watermark: document.getElementById('watermark').value,
                
                // Timestamp
                savedAt: new Date().toISOString()
            };
        }

        // Apply design data to the form
        function applyDesignData(designData) {
            // Page Settings
            if (designData.pageSize) document.getElementById('pageSize').value = designData.pageSize;
            if (designData.orientation) {
                document.querySelectorAll('[data-orientation]').forEach(btn => {
                    btn.classList.toggle('active', btn.dataset.orientation === designData.orientation);
                });
            }
            updatePageSize();
            
            // Apply other settings here...
            // This would need to be expanded to apply all design settings
            
            showNotification('Design applied successfully!');
        }

        // Update the designs list
        function updateDesignsList(designs) {
            const templatesContainer = document.getElementById('savedDesignsGrid');
            if (!templatesContainer) return;
            
            if (designs.length === 0) {
                templatesContainer.innerHTML = `
                    <div class="template-preview">
                        <i class="fas fa-folder-open"></i>
                        <div>No saved designs yet</div>
                    </div>
                `;
                return;
            }
            
            templatesContainer.innerHTML = '';
            
            designs.forEach(design => {
                const designCard = document.createElement('div');
                designCard.className = 'template-card';
                designCard.innerHTML = `
                    <div class="template-preview">
                        <i class="fas fa-file-medical fa-2x"></i>
                    </div>
                    <div class="template-name">${design.name}</div>
                    <div class="template-actions">
                        <button class="btn btn-sm btn-primary" onclick="loadDesignFromBackend(${design.id})">
                            <i class="fas fa-download"></i> Load
                        </button>
                        <button class="btn btn-sm btn-outline" onclick="deleteDesignFromBackend(${design.id}, '${design.name}')">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                    <div class="template-date" style="font-size: 0.7rem; color: #666; margin-top: 0.25rem;">
                        ${new Date(design.createdAt).toLocaleDateString()}
                    </div>
                `;
                templatesContainer.appendChild(designCard);
            });
        }

        // Load quick template
        function loadQuickTemplate(templateName) {
            showNotification(`Quick template "${templateName}" loaded!`);
            // Add quick template logic here
        }

        // Update the save button to use backend
        document.getElementById('saveBtn').addEventListener('click', function() {
            saveDesign(); // Keep local storage
            saveDesignToBackend(); // Save to backend
        });

        // Add back button functionality
        document.getElementById('backBtn').addEventListener('click', function() {
            window.location.href = '/';
        });

        // Load designs when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Your existing initialization code...
            
            // Load saved designs from backend
            loadSavedDesigns();
        });

        // Your existing JavaScript functions continue here...
        // (All your original pad.html JavaScript code should be included below)

        // ... [Include all your original JavaScript functions from pad.html here]

    </script>
</body>
</html>